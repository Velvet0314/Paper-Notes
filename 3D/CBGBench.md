1. 问题陈述（Problem Statement）
	- 对于一个由蛋白质-分子对组成的结合系统 $(\mathcal{P}, \mathcal{M})$，其中蛋白质包含 $N_{\text{rec}}$ 个原子，分子包含 $N_{\text{lig}}$ 个原子
		- 将蛋白质原子的索引集表示为 $\mathcal{I}_{\text{rec}}$，分子原子的索引集表示为 $\mathcal{I}_{\text{lig}}$，其中 $|\mathcal{I}_{\text{rec}}| = N_{\text{rec}}$ 且 $|\mathcal{I}_{\text{lig}}| = N_{\text{lig}}$。
		- 结合图可以被视为两个子图的并集。一个子图是蛋白质结构，记作 $\mathcal{P} = (\mathcal{V}_{\text{rec}}, \mathcal{E}_{\text{rec}})$
			- 其中 $\mathcal{V}_{\text{rec}} = \{(a_i, \mathbf{x}_i, s_i)\}_{i \in \mathcal{I}_{\text{rec}}}$ 是节点集，$\mathcal{E}_{\text{rec}} = \{(i, j, e_{i,j})\}_{i,j \in \mathcal{I}_{\text{rec}}}$ 是边集
			- 这里，$a_i$ 是原子类型，有 $a_i = 1, \ldots, M$，$\mathbf{x}_i \in \mathbb{R}^3$ 是对应的三维位置
			- $s_i = 1, \ldots, 20$ 是氨基酸类型，表示第 $i$ 个原子所属的氨基酸类型
			- $i, j$ 之间的元素表示它们之间存在键，边类型为 $e_{i,j}$
		- 类似地，分子结构图记作 $\mathcal{M} = (\mathcal{V}_{\text{lig}}, \mathcal{E}_{\text{lig}})$，其中 $\mathcal{V}_{\text{lig}} = {(a_i, \mathbf{x}_i)}_{i \in \mathcal{I}_{\text{lig}}}$，$\mathcal{E}_{\text{lig}}$ 是与 $\mathcal{E}_{\text{rec}}$ 具有相同形式的边集
		- 此外，在蛋白质和分子之间存在虚拟边，它们构成了结合图中的交叉边集 $\mathcal{E}_{\text{cross}}$
	- 为了填补空白，分子生成模型旨在学习 $p(\mathcal{M}|\mathcal{P})$ 的概率，以填补蛋白质口袋中的空白，生成一个分子 $p(\cdot)$
	- 如果我们也将分子中的原子划分为已知原子和待生成原子，令 $\mathcal{C}$ 为已知原子的集合，我们将原子生成任务写作 $\mathcal{G} = (\mathcal{V}_{\text{new}}, \mathcal{E}_{\text{cts}})$，其中 $\mathcal{I}_{\text{cts}} = \mathcal{I}_{\text{lig}} \setminus \mathcal{I}_{\text{new}}$，因此，针对 **填补分子部分空白** 的生成模型目标是学习 $p(\mathcal{G}|\mathcal{C}, \mathcal{P})$ 的概率
2. 任务的统一表述
	- 目标：**将所有结构化药物生成任务，抽象并统一到一个单一的、通用的概率图生成框架下**。这个框架不仅描述了传统的“从头生成”，更能无缝地涵盖“连接子设计”、“片段增长”等更复杂的分子优化任务
	- 方法：
		- 首先，文章将蛋白质-配体复合物系统定义为一个异构图（heterogeneous graph）
			* **蛋白质 (Protein, P)**：
			    $$ P = (V_{rec}, E_{rec}) $$
			    * **变量定义**：
			        * $V_{rec} = \{(a_i, x_i, s_i)\}_{i \in \mathcal{I}_{rec}}$：蛋白质的**节点集**
			            * $a_i$：第 $i$ 个原子的**原子类型** (如C, N, O)
			            * $x_i \in \mathbb{R}^3$：第 $i$ 个原子的**三维坐标**
			            * $s_i$：第 $i$ 个原子所属的**氨基酸类型** (如ALA, LYS)
			            * $\mathcal{I}_{rec}$：蛋白质原子的索引集合
			        * $E_{rec}$：蛋白质的**边集**，代表原子间的化学键
			* **配体 (Molecule, M)**：
			    $$ M = (V_{lig}, E_{lig}) $$
			    * **变量定义**：
			        * $V_{lig} = \{(a_i, x_i)\}_{i \in \mathcal{I}_{lig}}$：配体分子的**节点集**
			        * $E_{lig}$：配体分子的**边集**（化学键）
		- 两个核心的概率生成目标：
			- **公式 1: 从头分子生成 (*de novo* molecule generation)**
				$$ p(M|P) $$
				* **变量定义:**
				    * $p(\cdot)$：概率分布
				    * $M$：要生成的完整配体分子
				    * $P$：给定的蛋白质口袋环境
				* **直观解释**：这是 SBDD 最经典的任务。公式的含义是：“给定一个蛋白质口袋 $P$ 的条件下，生成一个与之匹配的分子 $M$ 的概率是多少？” 我们的生成模型就是要学习这个**条件概率分布** $p(M|P)$
				* **与模型的联系**：在训练中，我们最大化真实分子对的对数似然 $\log p(M_{true}|P)$。在推理（采样）时，我们从模型学到的这个分布中采样，生成新的分子。这正是所有条件生成模型的根本目标
			- **公式 2: “填空”式通用生成 (Fill-in-the-blank Generalization)**
				$$ p(G|C, P) $$
				* 目标：这是本文最核心的**概念创新**。它将单一的生成任务扩展为一个更通用的“图补全”任务
				* **变量定义**：
				    * $G = (V_{gen}, E_{gen})$：代表分子中需要**生成的部分**
				    * $C = (V_{ctx}, E_{ctx})$：代表分子中已知的**上下文部分**
				    * $P$：依然是蛋白质口袋环境
				* **直观解释**：这个公式的精妙之处在于它的普适性。它将分子分为“已知”和“未知”两部分，目标是在蛋白质口袋 $P$ 和分子已知部分 $C$ 的双重条件下，生成未知部分 $G$
				    * **如果上下文 $C$ 为空集**，任务就退化为 $p(G|P)$，即经典的**从头生成（de novo）**
				    * **如果上下文 $C$ 是两个不相连的分子片段**，任务就是**连接子设计 (Linker Design)**，目标是生成一个连接子 $G$ 把它们连起来
				    * **如果上下文 $C$ 是一个核心骨架**，任务就是**侧链修饰 (Side Chain Decoration)**，目标是生成侧链 $G$
				    * **如果上下文 $C$ 是一个分子片段**，任务就是**片段增长 (Fragment Growing)**
				    * **如果上下文 $C$ 是 一组不相连的侧链片段**，任务就是**骨架跃迁 (Scaffold Hopping)**
				* **与模型的联系**：这个统一的范式意味着，我们可以用**同一个模型架构**来解决所有这些任务，只需在输入时改变条件信息 $(C, P)$ 即可。这极大地增强了模型的可扩展性和实用性
3. 系统化的评测体系
	- **指标簇一 & 二：亚结构 (Substructure) & 化学性质 (Chemical Property)**
		- 这两部分评估的是“**生成的是不是一个‘像样’的药**”
		* **所用公式/指标:** `JSD` (Jensen-Shannon Divergence), `MAE` (Mean Absolute Error) on atom/ring/functional group distributions; `QED`, `SA`, `LogP`等
		* 指标解析：
		    * **亚结构分析**关注的是“化学语法”对不对。模型生成的分子中，各种官能团、环结构、原子类型的**分布**是否与真实的药物分子库一致？`JSD`和`MAE`就是用来衡量这种分布差异的。一个低`JSD`值意味着模型学到了正确的化学语言，而不是在胡乱拼接原子
		    * **化学性质**则关注分子的“药学属性”，比如药物相似性(QED)、合成可及性(SA)等

	- **指标簇三：相互作用 (Interaction)**
		- 这部分评估的是“**生成的药和靶点结合得好不好**”。
		* **公式 3: 配体结合效率 (Ligand Binding Efficacy, LBE)**
		    $$ \text{LBE} = -\frac{E_{\text{vina}}}{N_{\text{lig}}} $$
	    * **变量定义:**
	        * $E_{\text{vina}}$：由AutoDock Vina等对接软件计算出的**结合亲和力（对接分数）**，该值越负代表结合越好
	        * $N_{\text{lig}}$：配体分子中的**重原子数量**（非氢原子）
	    * **直观解释**：这是整个评测体系中最具洞察力的指标之一。单纯使用 $E_{\text{vina}}$ 有一个巨大缺陷：**分子越大，通常越容易获得更好的对接分数**，因为它有更多原子可以与口袋发生相互作用。这是一个强烈的偏见！LBE通过将对接分数**归一化**到每个重原子上，来修正这个偏见。它衡量的是“**平均每个原子对结合的贡献有多大**”，即**结合的效率**。一个高LBE意味着分子“短小精悍”，用更少的原子实现了更强的结合，这在药物发现中是极为重要的特性（通常与更好的药代动力学性质相关）
	    * **与模型的联系**：LBE 是一个后处理评估指标，它不直接参与模型训练的损失函数，但在模型对比和筛选时，它比原始的 $E_{\text{vina}}$ 更加公平和有意义
	- **指标簇四：几何构象 (Geometry)**
		- 这部分评估的是“**生成的分子3D结构是否真实合理**”
		* **所用公式/指标:** `JSD_BL` (键长分布), `JSD_BA` (键角分布), `Ratio_cc` (Clash ratio, 原子碰撞率)。
		* 指标解析：
		    * 键长和键角的分布是否符合化学常识？（例如，碳碳单键的长度应在1.54Å左右）
		    * 生成的分子原子是否与蛋白质原子发生了“碰撞”（van der Waals半径重叠）？过高的碰撞率意味着生成的构象在物理上是不稳定的