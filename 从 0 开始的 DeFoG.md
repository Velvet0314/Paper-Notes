1. è¶…å‚æ•°ä¸å„ç±»é…ç½®
	- é€šè¿‡ Hydra å’Œ OmegaConf è¿›è¡Œé…ç½®
2. æ•°æ®é›†åŠ è½½ â€”â€” ä»¥ QM9_no_H ä¸ºä¾‹
	- æš‚æ—¶ç©ºç€
3. é¢å¤–çš„å›¾ç‰¹å¾æå–åˆå§‹åŒ– â€”â€” `extra_features`
	- ç›®çš„ï¼šä¸ºå›¾ç¥ç»ç½‘ç»œè¡¥å……ç»“æ„ç‰¹å¾ â€”â€” ä»£ç ä¸­ç»™å‡ºäº†ä¸ƒç§æ–¹å¼ï¼Œé»˜è®¤é‡‡ç”¨çš„æ˜¯ `rrwp`ï¼Œé’ˆå¯¹ä¸åŒçš„åˆ†å­é›†çš„ç‰¹å¾åº”è¯¥é€‰ç”¨ä¸åŒçš„æ–¹å¼
		1. `cycles`ï¼šä»…ä½¿ç”¨å¾ªç¯ç‰¹å¾ (k-cycles)
		2. `eigenvalues`ï¼šä½¿ç”¨å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ç‰¹å¾å€¼
		3. `rrwp`ï¼šéšæœºæ¸¸èµ°æ ¸å¿ƒç‰¹å¾ï¼ˆRegularized Random Walk Kernelsï¼‰
		4. `rrwp_double`ï¼šRRWP ç‰¹å¾ + éå½’ä¸€åŒ–ç‰ˆæœ¬
		5. `rrwp_only`ï¼šä»… RRWPï¼ˆä¸å«å¾ªç¯ç‰¹å¾ï¼‰
		6. `rrwp_comp`ï¼šRRWP è¡¥é›†ç‰ˆæœ¬ï¼ˆè€ƒè™‘å›¾çš„è¡¥å›¾ï¼‰
		7. `all`ï¼šæ‰€æœ‰ç‰¹å¾çš„ç»„åˆï¼ˆå¾ªç¯ + ç‰¹å¾å€¼ + ç‰¹å¾å‘é‡ï¼‰
	- é¢å¤–çš„ç‰¹å¾
		1. å›¾çš„æœ€å¤§èŠ‚ç‚¹æ•° `self.max_n_nodes = dataset.info.max_nodes = 9`
		2. å¾ªç¯ç‰¹å¾è®¡ç®— `self.ncycles = NodeCycleFeatures()`
			- æ¦‚å¿µï¼š
				- k-cyclesï¼š**k-åœˆï¼ˆk-cycleï¼‰**Â æ˜¯æŒ‡é•¿åº¦ä¸º k çš„ç¯ï¼Œå³ç”± k ä¸ªèŠ‚ç‚¹å’Œ k æ¡è¾¹ç»„æˆçš„é—­åˆè·¯å¾„
		3. æå–ç‰¹å¾çš„æ–¹å¼ `features_type = extra_features_type = rrwp` 
		4. `rrwp` çš„æ­¥æ•° `self.rrwp_steps = rrwp_steps = 12`
		5. å½’ä¸€åŒ–çš„éšæœºæ¸¸èµ°æ ¸ `self.RRWP = RRWPFeatures()`
		6. éå½’ä¸€åŒ–çš„éšæœºæ¸¸èµ°æ ¸ `self.RWP = RRWPFeatures(normalize=False)`
4. åˆ†å­çš„ç‰¹å¾æå–åˆå§‹åŒ– â€”â€” `domain_features`
	- ç›®çš„ï¼šä»æ•°æ®é›†ä¸­æå–åˆ†å­çš„åŒ–å­¦ç‰¹å¾
	- åˆ†å­çš„ç‰¹å¾
		1. ç”µè· `self.charge = ChargeFeature()`
		2. åŒ–åˆä»· `self.valency = ValencyFeature()`
		3. åˆ†å­é‡ `self.weight = WeightFeature()`
5. è®¡ç®—æ¨¡å‹çš„è¾“å…¥/è¾“å‡ºçš„ç»´åº¦
	- PyG ç¨€ç–å›¾ç»“æ„
		1. èŠ‚ç‚¹ç‰¹å¾çŸ©é˜µ `x` â€”â€” `x.shape = [num_nodes, num_node_features]`
			- ä½œç”¨ï¼šä¿å­˜åˆ†å­å›¾çš„åŸå­ç±»å‹
			- ä¾‹å­ï¼šä¸€ä¸ªåˆ†å­æœ‰ 5 ä¸ªåŸå­ï¼Œæ¯ä¸ªåŸå­ç”¨ $\text{one-hot}$ ç¼–ç ï¼ˆC, N, O, Hï¼‰
				```python
				x = [[1, 0, 0, 0],   # èŠ‚ç‚¹ 0: ç¢³
					 [1, 0, 0, 0],   # èŠ‚ç‚¹ 1: ç¢³  
					 [0, 1, 0, 0],   # èŠ‚ç‚¹ 2: æ°®
					 [0, 0, 1, 0],   # èŠ‚ç‚¹ 3: æ°§
					 [0, 0, 0, 1]]   # èŠ‚ç‚¹ 4: æ°¢
				# x.shape:[5, 4]
				```
		2. è¾¹ç´¢å¼•çŸ©é˜µ `edge_index` â€”â€” `edge_index.shape = [2, nums_edges]`
			- ä½œç”¨ï¼šä¿å­˜å›¾ä¸­èŠ‚ç‚¹å’ŒèŠ‚ç‚¹çš„è¿æ¥å…³ç³»
			- ä¾‹å­ï¼šç¬¬ä¸€è¡Œæ˜¯æºèŠ‚ç‚¹ï¼Œç¬¬äºŒè¡Œæ˜¯ç›®æ ‡èŠ‚ç‚¹
			```python
				è¾¹åˆ—è¡¨ï¼ˆæ— å‘å›¾éœ€è¦åŒå‘å­˜å‚¨ï¼‰ï¼š
				0 â†’ 1, 1 â†’ 0, 1 â†’ 2, 2 â†’ 1, 1 â†’ 3, 3 â†’ 1
				
				edge_index = [[0, 1, 1, 2, 1, 3],   # æºèŠ‚ç‚¹
				              [1, 0, 2, 1, 3, 1]]   # ç›®æ ‡èŠ‚ç‚¹
				# edge_index.shape = [2, 6]
			```
		3. è¾¹ç‰¹å¾çŸ©é˜µ `edge_attr` â€”â€” `edge_attr.shape = [num_edges, num_edge_features]`
			- ä½œç”¨ï¼šä¿å­˜æ¯æ¡è¾¹çš„ç‰¹å¾ï¼Œä¸Â `edge_index` ä¸€ä¸€å¯¹åº”
			- ä¾‹å­ï¼šåŒ–å­¦é”®ç±»å‹ï¼ˆ$\text{one-hot}$ï¼šå•é”®ã€åŒé”®ã€ä¸‰é”®ç­‰ï¼‰
			```python
			# ç‰¹å¾é•¿åº¦+1æ˜¯å› ä¸ºé¢„ç•™äº† [1,0,0,0] è¡¨ç¤ºæ— è¾¹ï¼Œåœ¨ç¨€ç–çŸ©é˜µé‡Œä¸ä¼šå­˜å‚¨æ— è¾¹
			edge_attr = [[0,1,0,0],  # è¾¹ 0â†’1: å•é”®
			             [0,1,0,0],  # è¾¹ 1â†’0: å•é”®
			             [0,0,1,0],  # è¾¹ 1â†’2: åŒé”®
			             [0,0,1,0],  # è¾¹ 2â†’1: åŒé”®
			             [0,1,0,0],  # è¾¹ 1â†’3: å•é”®
			             [0,1,0,0]]  # è¾¹ 3â†’1: å•é”®
			# edge_attr.shape:[6, 4]
			```
		4.  æ‰¹æ¬¡ç´¢å¼• `batch` â€”â€” `batch.shape = [total_num_nodes]`
			- ä½œç”¨ï¼šå½“å¤šä¸ªå›¾è¢«æ‰“åŒ…æˆä¸€ä¸ª batch æ—¶ï¼Œ`batch` æ ‡è®°æ¯ä¸ªèŠ‚ç‚¹å±äºå“ªä¸ªå›¾
			- ä¾‹å­ï¼š3 ä¸ªå›¾æ‰“åŒ…åœ¨ä¸€èµ·
			```python
			å›¾ 0: 2 ä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹ 0, 1)
			å›¾ 1: 3 ä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹ 2, 3, 4)
			å›¾ 2: 2 ä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹ 5, 6)
			batch = [0, 0, 1, 1, 1, 2, 2]
			         â†‘  â†‘  â†‘  â†‘  â†‘  â†‘  â†‘
					å›¾0    å›¾1      å›¾2
			```
	- ç¨€ç–å›¾è½¬ç¨ å¯†å›¾
		1. èŠ‚ç‚¹ç‰¹å¾çŸ©é˜µè½¬ç¨ å¯†çŸ©é˜µ â€”â€” è°ƒç”¨ PyG çš„å‡½æ•° `to_dense_batch()`
			- è¿”å›ç¨ å¯†å›¾å’Œä¸€ä¸ª `node_mask`ï¼Œ`node_mask` è¡¨ç¤ºæ¯ä¸ªå›¾å“ªäº›èŠ‚ç‚¹æ˜¯çœŸå®çš„ï¼ˆå› ä¸ºè¦ padding åˆ° `max_num_nodes`ï¼Œéœ€è¦ä¸€ä¸ª mask æ— æ•ˆæ‰ padding çš„éƒ¨åˆ†ï¼‰
			- ä¾‹å­ï¼š
			```python
			Inï¼š
			# 3ä¸ªå›¾ï¼šå›¾0æœ‰2èŠ‚ç‚¹ï¼Œå›¾1æœ‰3èŠ‚ç‚¹ï¼Œå›¾2æœ‰2èŠ‚ç‚¹
			x = [[1,0],    # èŠ‚ç‚¹0 (å›¾0)
				 [0,1],    # èŠ‚ç‚¹1 (å›¾0)
				 [1,0],    # èŠ‚ç‚¹2 (å›¾1)
				 [1,1],    # èŠ‚ç‚¹3 (å›¾1)
				 [0,1],    # èŠ‚ç‚¹4 (å›¾1)
				 [1,0],    # èŠ‚ç‚¹5 (å›¾2)
				 [0,0]]    # èŠ‚ç‚¹6 (å›¾2)
			# x.shape = [7, 2]
			batch = [0, 0, 1, 1, 1, 2, 2]
			
			Out:
			# max_num_nodes = 3ï¼ˆå›¾1æœ€å¤§ï¼‰
			X = [[[1,0], [0,1], [0,0]],    # å›¾0: 2èŠ‚ç‚¹ + 1ä¸ªpadding
				 [[1,0], [1,1], [0,1]],    # å›¾1: 3èŠ‚ç‚¹
				 [[1,0], [0,0], [0,0]]]    # å›¾2: 2èŠ‚ç‚¹ + 1ä¸ªpadding
			# X.shape: [3, 3, 2]  â†’ [batch_size, max_nodes, features]
			
			node_mask = [[True,  True,  False],   # å›¾0: å‰2ä¸ªæ˜¯çœŸå®èŠ‚ç‚¹
						 [True,  True,  True ],   # å›¾1: å…¨æ˜¯çœŸå®èŠ‚ç‚¹
						 [True,  True,  False]]   # å›¾2: å‰2ä¸ªæ˜¯çœŸå®èŠ‚ç‚¹
			# node_mask.shape:[3, 3]
			```
		2. å»æ‰è¾¹ç´¢å¼•å’Œè¾¹ç‰¹å¾ï¼ˆ`edge_index, edge_attr`ï¼‰çŸ©é˜µä¸­çš„è‡ªç¯ â€”â€” è°ƒç”¨ PyG `torch_geometric.utils.remove_self_loops()`
		3. è¾¹åˆ—è¡¨è½¬é‚»æ¥çŸ©é˜µ â€”â€” è°ƒç”¨ PyG `to_dense_adj()`
			- ä¾‹å­ï¼š
			```python
			Inï¼š
			# å›¾0: 0-1 å•é”®
			# å›¾1: 0-1 åŒé”®, 1-2 å•é”®
			edge_index = [[0, 1, 2, 3, 3, 4],   # æºèŠ‚ç‚¹(å…¨å±€ç´¢å¼•)
						  [1, 0, 3, 2, 4, 3]]   # ç›®æ ‡èŠ‚ç‚¹
			
			edge_attr = [[0, 1, 0, 0],  # 0â†’1 å•é”®
						 [0, 1, 0, 0],  # 1â†’0 å•é”®
						 [0, 0, 1, 0],  # 2â†’3 åŒé”®(åªçœ‹å›¾1çš„ç´¢å¼•æ˜¯èŠ‚ç‚¹0â†’1)
						 [0, 0, 1, 0],  # 3â†’2 åŒé”®
						 [0, 1, 0, 0],  # 3â†’4 å•é”®(åªçœ‹å›¾1çš„ç´¢å¼•æ˜¯èŠ‚ç‚¹1â†’2)
						 [0, 1, 0, 0]]  # 4â†’3 å•é”®
			
			batch = [0, 0, 1, 1, 1]
			
			Outï¼š
			E.shape = [batch_size, max_nodes, max_nodes, edge_features]
					= [2, 3, 3, 4]
			
			# å›¾0 çš„é‚»æ¥çŸ©é˜µ (3Ã—3Ã—4)
			E[0] = [
				#    èŠ‚ç‚¹0          èŠ‚ç‚¹1     èŠ‚ç‚¹2(padding)
				[[0, 0, 0, 0], [0, 1, 0, 0], [0, 0, 0, 0]],  # ä»èŠ‚ç‚¹0å‡ºå‘
				[[0, 1, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],  # ä»èŠ‚ç‚¹1å‡ºå‘
				[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]   # padding è¡Œ
			]
			
			# å›¾1 çš„é‚»æ¥çŸ©é˜µ (3Ã—3Ã—4)
			E[1] = [
				#    èŠ‚ç‚¹0          èŠ‚ç‚¹1         èŠ‚ç‚¹2
				[[0, 0, 0, 0], [0, 0, 1, 0], [0, 0, 0, 0]],  # åªçœ‹å›¾1çš„ç´¢å¼•æ˜¯èŠ‚ç‚¹0â†’1: åŒé”®
				[[0, 0, 1, 0], [0, 0, 0, 0], [0, 1, 0, 0]],  # åªçœ‹å›¾1çš„ç´¢å¼•æ˜¯èŠ‚ç‚¹1â†’0: åŒé”®, 1â†’2: å•é”®
				[[0, 0, 0, 0], [0, 1, 0, 0], [0, 0, 0, 0]]   # åªçœ‹å›¾1çš„ç´¢å¼•æ˜¯èŠ‚ç‚¹2â†’1: å•é”®
			]
			```
		4. ç¼–ç æ— è¾¹ç±»å‹ â€”â€” è°ƒç”¨ `encode_no_edge()`
			- ä½œç”¨ï¼šå› ä¸ºç¨€ç–å›¾åªå­˜å‚¨å­˜åœ¨çš„è¾¹ï¼Œæ‰€ä»¥ä¸éœ€è¦è¡¨ç¤º"æ— è¾¹"ï¼Œè½¬æ¢æˆç¨ å¯†å›¾åï¼Œç”±äºæ— è¾¹çš„ä½ç½®è¢«padding æˆäº† 0ï¼Œå¯¼è‡´æ²¡æœ‰æœ‰æ•ˆçš„ $\text{one-hot}$ ä¸ä¹‹å¯¹åº”
			1. åˆ¤æ–­æ˜¯å¦æœ‰è¾¹ç‰¹å¾
				```python
				if E.shape[-1] == 0: # å› ä¸º E çš„æœ€åä¸€ä¸ªç»´åº¦å°±æ˜¯ edge_features
					return E
				```
			2. å¯¹æœ€åä¸€ä¸ªç»´åº¦æ±‚å’Œ â€”â€” `no_edge = torch.sum(E, dim=3) == 0`
				- ä½œç”¨ï¼šæ‰¾åˆ°å“ªäº›æ˜¯â€œæ— è¾¹â€
				```python
				E[0] = [
					#    èŠ‚ç‚¹0          èŠ‚ç‚¹1     èŠ‚ç‚¹2(padding)
					[[0, 0, 0, 0], [0, 1, 0, 0], [0, 0, 0, 0]],  # ä»èŠ‚ç‚¹0å‡ºå‘
					[[0, 1, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]],  # ä»èŠ‚ç‚¹1å‡ºå‘
					[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]   # padding è¡Œ
				]
				
				E[0]_sum = torch.sum(E[0], dim=3) # æ±‚å’Œåæ¶ˆå»äº†æœ€åä¸€ä¸ªç»´åº¦
				
				# no_edge.shape:[2, 3, 3]
				
				# ç›¸å½“äºå¯¹æ¯ä¸ªä»£è¡¨è¾¹ç‰¹å¾çš„ one-hot å‘é‡å†…éƒ¨å…ƒç´ æ±‚å’Œ
				# å¦‚æœæ˜¯å…¨ 0 çš„æ— è¾¹ç±»å‹ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯ 0
				E[0]_sum = [
					[0, 1, 0],  
					[1, 0, 0],
					[0, 0, 0]
				] â†’ è¿™ä¸ªå°±æ˜¯ no_edge é‡Œçš„ç¬¬ä¸€ä¸ªç»´åº¦çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šå›¾ 0
				no_edge[0] = [
					[False, True, False],  
					[True, False, False],
					[False, False, False]
				]
				```
			3. å¡«å……æ— è¾¹ padding ä¸ºé¢„ç•™çš„ $\text{one-hot}$ `[1,0,...,0]`
				- ä½œç”¨ï¼šå°†æ— è¾¹ä¹Ÿèƒ½ç”¨ $\text{one-hot}$ è¡¨ç¤º
				```python
				first_elt = E[:, :, :, 0] # å–æœ€åä¸€ä¸ªç»´åº¦çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
				# first_elt.shape:[2, 3, 3] = no_edge.shape:[2 ,3, 3]
				
				# Pytorch å¸ƒå°”ç´¢å¼•è¯­æ³•ï¼štensor[å¸ƒå°”æ©ç ] = å€¼ï¼Œéœ€è¦ shape åŒ¹é…æ‰èƒ½ç”¨
				first_elt[no_edge] = 1    # æŠŠæ‰€æœ‰çš„æ— è¾¹çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç½®ä¸º 1
				E[:, :, :, 0] = first_elt # æ˜¾å¼å†™å› E
				```
			4. ä¿®æ­£å¯¹è§’çº¿çš„é—®é¢˜
				- ä½œç”¨ï¼šå› ä¸ºè½¬æˆç¨ å¯†çŸ©é˜µçš„æ—¶å€™æ²¡æœ‰è‡ªç¯ï¼Œæ‰€ä»¥å¯¹è§’çº¿é»˜è®¤ä¹Ÿæ˜¯æ— è¾¹çš„ padding æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯ç¬¬ 3 æ­¥æ“ä½œå°†å¯¹è§’çº¿ä¹Ÿæ ‡è®°æˆæ— è¾¹çš„ $\text{one-hot}$ `[1,0,...,0]`äº†ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ­£å›æ¥
				```python
				diag = (
					torch.eye(E.shape[1], dtype=torch.bool).unsqueeze(0).expand(E.shape[0], -1, -1)
				)
				# torch.eye(E.shape[1], dtype=torch.bool) shape:[3, 3]
				# unsqueeze(0): åœ¨æœ€å‰é¢(ä½ç½® 0)æ·»åŠ ä¸€ä¸ª batch ç»´åº¦(1) shape:[1, 3, 3]
				# expand(E.shape[0], -1, -1): æ‰©å±•åˆ° batch_size ä»½(ä¸å¤åˆ¶å†…å­˜ï¼Œåªæ˜¯å¹¿æ’­) shape:[2, 3, 3]
				
				E[diag] = 0
				# é€šè¿‡å¹¿æ’­æœºåˆ¶ï¼Œè®©ç¬¬å››ä¸ªç»´åº¦ä¸å˜ï¼Œåªæ”¹å˜äº†å¯¹è§’çº¿çš„ one-hotï¼Œæ˜¯ç›´æ¥å°†æ•´ä¸ªå¯¹è§’çº¿å‘é‡æ”¹æˆ 0 å‘é‡ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰æ˜¯é€‰å‡ºç¬¬å››ä¸ªç»´åº¦çš„ç¬¬ä¸€ä¸ªå…ƒç´ å»ä¿®æ”¹
				```
	- è®¡ç®—è¾“å…¥ç»´åº¦
		1. ä»ç¨ å¯†å›¾æå– `X, E`
			- èŠ‚ç‚¹ç»´åº¦
			- è¾¹ç»´åº¦
			- `node_mask` çš„ç»´åº¦
		2. æ•°æ®é›†æœ¬èº«ä¼ é€’çš„ä¸€äº›å›¾çš„å…¨å±€ç‰¹å¾ `y`
			- å† `+1`ï¼Œç”¨äºä¼ é€’æ—¶é—´æ­¥çš„ä¿¡æ¯ï¼ˆåŸæ³¨é‡Šï¼š# + 1 due to time conditioningï¼‰
		3. é¢å¤–çš„å›¾ç‰¹å¾ â€”â€” `extra_features: __call__ function`
			- è¾“å…¥ï¼šnoisy_data åŒ…å«å™ªå£°æ•°æ®çš„å­—å…¸ï¼ˆç¨ å¯†å›¾ï¼‰
			- è¾“å‡ºï¼šä¸€ä¸ª PlaceHolderï¼ŒåŒ…å«å›¾çš„é¢å¤–ç‰¹å¾çš„å¯¹è±¡ï¼Œå…·æœ‰ Xã€Eã€y ä¸‰ä¸ªå±æ€§
				- Xï¼šé¢å¤–çš„èŠ‚ç‚¹ç‰¹å¾
				- Eï¼šé¢å¤–çš„è¾¹ç‰¹å¾
				- yï¼šé¢å¤–çš„å…¨å±€ç‰¹å¾
			1. è®¡ç®—å›¾çš„å¤§å°æ¯”ä¾‹
				```python
				# dim = 1 æŒ‰è¡Œæ±‚å’Œ(å¯¹ç¬¬äºŒä¸ªç»´åº¦é‡Œé¢çš„å†…å®¹æ±‚å’Œï¼Œæ¶ˆå»äº†ç¬¬äºŒä¸ªç»´åº¦)
				# node_mask = [[True, True, False], å›¾0
				#			[True, True, True],     å›¾1
				#			[True, True, False]]    å›¾2
				# node_mask.sum(dim=1) = [2, 3, 2]
				# node_mask.sum(dim=1).unsqueeze(1) = [[2], [3], [2]] åœ¨ä½ç½® 1 æ·»åŠ ä¸€ä¸ª batch ç»´åº¦(1)
				# æ€è€ƒï¼šnode_mask.sum(dim=1).unsqueeze(1) å…¶å®åº”ä¸º [[2, 3, 2]]
				n = noisy_data["node_mask"].sum(dim=1).unsqueeze(1) / self.max_n_nodes # é™¤ä»¥æœ€å¤§èŠ‚ç‚¹æ•°ï¼Œå½’ä¸€åŒ–åˆ° [0, 1]
				```
			2. è®¡ç®— k-å¾ªç¯ç‰¹å¾ â€”â€” åŠ å…¥åˆ°å›¾çš„å…¨å±€ç‰¹å¾ `y` ä¸­
			3. è®¡ç®—é€‰å®šçš„ç‰¹å¾ç±»å‹ â€”â€” æ ‡å‡† RRWP
				- RRWP è¯¦è§£
					1. RRWP çš„æ¦‚å¿µï¼šRandom Walk with Restart Positional Encodingï¼ˆéšæœºæ¸¸èµ°ä½ç½®ç¼–ç ï¼‰
						- æ¯ä¸€æ­¥ï¼Œä»å½“å‰èŠ‚ç‚¹éšæœºé€‰æ‹©ä¸€æ¡è¾¹èµ°åˆ°é‚»å±…èŠ‚ç‚¹
						- RRWP è®¡ç®—çš„æ˜¯ï¼šä»èŠ‚ç‚¹ $i$ å‡ºå‘ï¼Œèµ° $k$ æ­¥ååˆ°è¾¾èŠ‚ç‚¹ $j$ çš„æ¦‚ç‡
					2. æ•°å­¦åŸç†
						- æ¦‚ç‡è½¬ç§»çŸ©é˜µ
							$$P = D^{-1} A$$
							å…¶ä¸­ï¼š
							- $A$ï¼šé‚»æ¥çŸ©é˜µï¼ˆ$A[i, j] = 1$ è¡¨ç¤º $i$ å’Œ $j$ ä¹‹é—´æœ‰è¾¹ï¼‰
							- $D$ï¼šåº¦çŸ©é˜µï¼ˆå¯¹è§’çŸ©é˜µï¼Œ$D[i, i]=$ èŠ‚ç‚¹ $i$ çš„åº¦æ•°ï¼‰
							- $P$ï¼šæ¦‚ç‡è½¬ç§»çŸ©é˜µï¼ˆ$P[i ,j] =$ ä» $i$ ä¸€æ­¥èµ°åˆ° $j$ çš„æ¦‚ç‡ï¼‰
						- $k$ æ­¥éšæœºæ¸¸èµ°
							- $P^k[i,j] = \text{ä»èŠ‚ç‚¹ i å‡ºå‘ï¼Œæ°å¥½èµ° k æ­¥åˆ°è¾¾èŠ‚ç‚¹ j çš„æ¦‚ç‡}$
					3. ä»£ç è§£æ
						1. æ’é™¤æ— è¾¹ç±»åˆ« â€”â€” rrwp åªå…³å¿ƒæœ‰æ²¡æœ‰è¾¹ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨æœ€åä¸€ç»´
							```python
							# æ’é™¤æœ€åä¸€ç»´çš„ç¬¬ 0 ä¸ªå…ƒç´ ï¼Œä¹‹å‰ç¼–ç çš„æ— è¾¹ç±»å‹å°±å¤±æ•ˆäº†
							# å†å¯¹æœ€åä¸€ä¸ªç»´åº¦æ±‚å’Œï¼Œåªæœ‰å•ä¸€çš„ 0/1 ä»£è¡¨æœ‰æ— è¾¹
							E = noisy_data["E_t"].float()[..., 1:].sum(-1)
							# E.shape:[batch_size, n ,n]
							```
						2. è®¡ç®—éšæœºæ¸¸èµ°æ ¸ç‰¹å¾ï¼šç”± `extra_features.py â€”â€” RRWPFeatures()` å®ç°
							```python
							rrwp_edge_attr = self.RRWP(E, k=self.rrwp_steps)
							self.RRWP = RRWPFeatures()
							
							class RRWPFeatures:
								def __call__(self, E, k=None):
									k = k or self.k
									bs, n, _ = E.shape
									# å¦‚æœéœ€è¦å½’ä¸€åŒ–ï¼Œè®¡ç®—è½¬ç§»çŸ©é˜µ D^{-1}A
									if self.normalize:
										# åˆå§‹åŒ–åº¦çŸ©é˜µ
										degree = torch.zeros(bs, n, n, device=E.device)
										
										# è®¡ç®—å‡ºåº¦ï¼ˆæ¯ä¸ªèŠ‚ç‚¹çš„åº¦æ•°ï¼‰
										# å¯¹äºæ— å‘å›¾ï¼šå‡ºåº¦ = å…¥åº¦ = åº¦æ•°
										# ç”±äº D æ˜¯å¯¹è§’çŸ©é˜µï¼Œæ‰€ä»¥ D çš„é€†çŸ©é˜µ D^{-1} å°±æ˜¯å¯¹è§’çº¿å…ƒç´ å–å€’ 
										to_fill = 1 / (E.sum(dim=-1).float())
										
										# å­¤ç«‹èŠ‚ç‚¹åº¦æ•°ä¸º 0ï¼Œ1/0 = inf
										# æ‰¾åˆ°åŸæœ¬ä¸º 0 çš„åœ°æ–¹ï¼Œå…¨éƒ¨å°† inf æ›¿æ¢ä¸º 0
										to_fill[E.sum(dim=-1).float() == 0] = 0
										# to_fill.shape:[éå­¤ç«‹èŠ‚ç‚¹æ•°, 1]
										
										# æ„é€ å¯¹è§’åº¦çŸ©é˜µ
										# degree æ˜¯ä¸‰ç»´å‘é‡ï¼Œå†™å›åˆ°ç¬¬2ã€3ç»´åº¦é‡Œ
										degree = torch.diagonal_scatter(degree, to_fill, dim1=1, dim2=2)
										
										# è½¬ç§»çŸ©é˜µ = D^{-1} @ A
										E = degree @ E
							```
						3. å¼€å§‹æ¸¸èµ°ï¼Œè¿­ä»£è®¡ç®—
							```python
							# åˆå§‹åŒ–ï¼šç¬¬ 0 æ­¥å³æ˜¯å•ä½çŸ©é˜µ I
							# [n, n] å•ä½çŸ©é˜µï¼Œunsqueeze(0) å¢åŠ  batch ç»´åº¦åˆ° [1, n, n]ï¼Œrepeat(bs, 1, 1) å¤åˆ¶ bs ä»½ [bs, n, n] 
							id = torch.eye(n, device=E.device).unsqueeze(0).repeat(bs, 1, 1)
							# åˆ—è¡¨ç”¨æ¥å­˜å‚¨æ‰€æœ‰æ­¥æ•°çš„çŸ©é˜µï¼Œç›®å‰åªæœ‰ P^0
							rrwp_list = [id]
							
							# è¿­ä»£è®¡ç®— P^1, P^2, ..., P^{k-1}
							for i in range(k - 1):
								cur_rrwp = rrwp_list[-1] @ E Â #  P^{i+1} = P^i @ E
								rrwp_list.append(cur_rrwp)
							
							# å †æ ˆæˆ [bs, n, n, k]
							return torch.stack(rrwp_list, -1)
							```
						4. æå–èŠ‚ç‚¹ç‰¹å¾
							```python
							# ä»å¯¹è§’çº¿ä¸Šæå–èŠ‚ç‚¹ç‰¹å¾ï¼ˆA^k[i,i] å¯¹è§’å…ƒç´ ï¼‰
							# ç”Ÿæˆå¯¹è§’çº¿ç´¢å¼•
							diag_index = torch.arange(rrwp_edge_attr.shape[1])
							
							# å¯¹äº diag_index = [0, 1, 2]
							# rrwp_edge_attr[:, [0,1,2], [0,1,2], :]
							# å±•å¼€å°±æ˜¯ï¼š
							# rrwp_edge_attr[:, 0, 0, :] Â â†’ èŠ‚ç‚¹0çš„å¯¹è§’ç‰¹å¾
							# rrwp_edge_attr[:, 1, 1, :] Â â†’ èŠ‚ç‚¹1çš„å¯¹è§’ç‰¹å¾
							# rrwp_edge_attr[:, 2, 2, :] Â â†’ èŠ‚ç‚¹2çš„å¯¹è§’ç‰¹å¾
							# ç”±äºå– n ä¸ªå¯¹è§’çº¿å…ƒç´ ï¼Œç»´åº¦å‡å°‘äº†ä¸€ä¸ª
							rrwp_node_attr = rrwp_edge_attr[:, diag_index, diag_index, :] Â # (bs, n, k)
							```
					4. æ€»ç»“
						- `rrwp_edge_attr`Â å‘Šè¯‰æ¨¡å‹ï¼šèŠ‚ç‚¹ $i$ å’ŒèŠ‚ç‚¹ $j$ ä¹‹é—´çš„"å›¾ä¸Šè·ç¦»"æ˜¯å¤šå°‘ï¼Œå®ƒä»¬é€šè¿‡å¤šå°‘æ­¥å¯ä»¥äº’ç›¸åˆ°è¾¾ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´æœ‰å¤šå°‘æ¡è·¯å¾„è¿æ¥
						- `rrwp_node_attr`Â å‘Šè¯‰æ¨¡å‹ï¼šè¿™ä¸ªèŠ‚ç‚¹åœ¨å›¾ä¸­å¤„äºä»€ä¹ˆæ ·çš„"ä½ç½®"â€”â€” æ˜¯åœ¨**å¯†é›†çš„ä¸­å¿ƒï¼ˆé«˜è¿”å›æ¦‚ç‡ï¼Œå› ä¸ºé‚»å±…å¤šå®¹æ˜“èµ°å›æ¥ï¼‰**ï¼Œè¿˜æ˜¯åœ¨**ç¨€ç–çš„è¾¹ç¼˜ï¼ˆä½è¿”å›æ¦‚ç‡ï¼Œä¸æ˜“èµ°å›æ¥ï¼‰**ï¼Œä»¥åŠå®ƒå‘¨å›´çš„å±€éƒ¨è¿æ¥æ¨¡å¼æ˜¯ä»€ä¹ˆæ ·çš„
		4. åˆ†å­çš„ç‰¹å¾ â€”â€” `class ExtraMolecularFeatures: __call__ function`
			- è¾“å…¥ï¼šnoisy_data åŒ…å«å™ªå£°æ•°æ®çš„å­—å…¸ï¼ˆç¨ å¯†å›¾ï¼‰
			- è¾“å‡ºï¼šä¸€ä¸ª PlaceHolderï¼ŒåŒ…å«åˆ†å­çš„ç‰¹å¾ï¼Œå…·æœ‰ Xã€Eã€y ä¸‰ä¸ªå±æ€§
				- Xï¼šæ¯ä¸ªåŸå­çš„ ç”µè·ï¼Œä»·æ€
				- Eï¼šç©ºçš„è¾¹ç‰¹å¾
				- yï¼šå½’ä¸€åŒ–åˆ†å­é‡
			1. è®¡ç®—å½¢å¼ç”µè·
				- é”®çº§ï¼šä¸€æ¡åŒ–å­¦é”®çš„å¼ºåº¦
				- åŸå­å½“å‰ä»·æ€ = è¯¥åŸå­çš„æ€»é”®çº§
				```python
				class ChargeFeature:
					def __call__(self, noisy_data):
					"""
					è®¡ç®—å½¢å¼ç”µè·ã€‚
					åŸç†ï¼š
					1. æ ¹æ®è¾¹ç‰¹å¾è®¡ç®—æ¯ä¸ªåŸå­å½“å‰è¿æ¥çš„æ€»é”®çº§
					2. æ ¹æ®èŠ‚ç‚¹ç‰¹å¾ç¡®å®šåŸå­ç±»å‹å¯¹åº”çš„æ­£å¸¸ä»·æ€
					3. ç”µè· = æ­£å¸¸ä»·æ€ - å½“å‰ä»·æ€
					"""
					
					# è·å–è¾¹ç±»å‹æ•°é‡ï¼Œåˆ¤æ–­æ˜¯å¦åŒ…å«èŠ³é¦™é”®
					# E_t æœ€åä¸€ä¸ªç»´åº¦æ˜¯ä»£è¡¨é”®çš„ç±»å‹çš„ one-hotï¼Œè¿™ä¸ª one-hot çš„é•¿åº¦å°±è¡¨ç¤ºæœ‰å‡ ç§ç±»å‹
					de = noisy_data["E_t"].shape[-1]
					
					if de == 5:
						# åŒ…å«èŠ³é¦™é”®ï¼š[æ— é”®, å•é”®, åŒé”®, ä¸‰é”®, èŠ³é¦™é”®]
						bond_orders = torch.tensor(
							[0, 1, 2, 3, 1.5], device=noisy_data["E_t"].device
						).reshape(1, 1, 1, -1)
					else:
						# ä¸å«èŠ³é¦™é”®ï¼š[æ— é”®, å•é”®, åŒé”®, ä¸‰é”®]
						bond_orders = torch.tensor(
							[0, 1, 2, 3], device=noisy_data["E_t"].device
						).reshape(1, 1, 1, -1)
					
					# è®¡ç®—åŠ æƒè¾¹ç‰¹å¾ï¼šE_t * bond_orders
					# å› ä¸º bond_order.shape:[1, 1, 1, de]ï¼Œç›¸ä¹˜å¹¿æ’­æ—¶åªå¯¹æœ€åä¸€ä¸ªç»´åº¦åšé€å…ƒç´ ç›¸ä¹˜ï¼Œå…¶ä»–ç»´åº¦è¿›è¡Œå¤åˆ¶
					weighted_E = noisy_data["E_t"] * bond_orders Â # (bs, n, n, de)
					
					# å¯¹æ¯æ¡è¾¹å–æœ€å¤§é”®çº§ï¼Œç„¶åå¯¹æ¯ä¸ªåŸå­çš„æ‰€æœ‰é‚»æ¥è¾¹æ±‚å’Œï¼Œå¾—åˆ°å½“å‰ä»·æ€
					âš  è¿™é‡Œä¼¼ä¹æœ‰é”™è¯¯ï¼Œè®¡ç®—æ€»é”®çº§çš„æ—¶å€™èŠ³é¦™é”®åº”æ˜¯ä¸º 1.5ï¼Œä½† argmax æ˜¯è¿”å›ç´¢å¼• 4
					ğŸ’¡ä¿®æ­£ï¼šcurrent_valencies = weighted_E.sum(dim=-1).sum(dim=-1)
					â­å®šè®ºï¼šargmax èƒ½åŒºåˆ«ä¸åŒç±»å‹å°±å¯ä»¥ï¼Œä¸ç”¨ä¿®æ”¹
					# ç„¶åå¯¹æ¯ä¸ªåŸå­çš„é‚»å±…æ±‚å’Œï¼Œå¾—åˆ°æ¯ä¸ªåŸå­å½“å‰çš„ä»·æ€
					# åŸå­çš„å½“å‰ä»·æ€ï¼ˆcurrent valencyï¼‰å°±æ˜¯è¯¥åŸå­è¿æ¥çš„æ‰€æœ‰é”®çš„é”®çº§ä¹‹å’Œ
					current_valencies = weighted_E.argmax(dim=-1).sum(dim=-1) Â # (bs, n)

					# æ„å»ºåŸå­ç±»å‹åˆ°æ­£å¸¸ä»·æ€çš„æ˜ å°„
					# ä¾‹å­ï¼šself.valencies = [4, 3, 2, 1, 1]ï¼Œå¯¹åº”Â [C, N, O, F, H]
					valencies = torch.tensor(
						self.valencies, device=noisy_data["X_t"].device
					).reshape(1, 1, -1)
					
					# åŒä¸Š
					X = noisy_data["X_t"] * valencies Â # (bs, n, dx)
					âš  ç›¸åŒçš„é”™è¯¯ï¼Œå¦‚æœ valencies åˆšå¥½æ˜¯é€’å‡çš„ï¼Œé‚£ä¹ˆæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„
					ğŸ’¡ä¿®æ­£ï¼šnormal_valencies = torch.sum(X, dim=-1)
					â­å®šè®ºï¼šargmax èƒ½åŒºåˆ«ä¸åŒç±»å‹å°±å¯ä»¥ï¼Œä¸ç”¨ä¿®æ”¹
					normal_valencies = torch.argmax(X, dim=-1) Â # (bs, n)
					
					# å½¢å¼ç”µè· = æ­£å¸¸ä»·æ€ - å½“å‰ä»·æ€
					# tensor_a.type_as(tensor_b) å°†Â `tensor_a`Â è½¬æ¢æˆä¸Â `tensor_b`Â ç›¸åŒçš„ dtype å’Œ device
					return (normal_valencies - current_valencies).type_as(noisy_data["X_t"])
				```
			2. è®¡ç®—å½“å‰ä»·æ€
				```python
				class ValencyFeature:
					def __call__(self, noisy_data):
						"""
						è®¡ç®—æ¯ä¸ªåŸå­çš„å½“å‰ä»·æ€(æ€»é”®çº§)
						"""Â  
						# è·å–è¾¹ç±»å‹æ•°é‡ï¼Œåˆ¤æ–­æ˜¯å¦åŒ…å«èŠ³é¦™é”®
						de = noisy_data["E_t"].shape[-1]
						if de == 5:
							# åŒ…å«èŠ³é¦™é”®
							bond_orders = torch.tensor(
								[0, 1, 2, 3, 1.5], device=noisy_data["E_t"].device
							).reshape(1, 1, 1, -1)
						else:
							# ä¸å«èŠ³é¦™é”®
							bond_orders = torch.tensor(
								[0, 1, 2, 3], device=noisy_data["E_t"].device
							).reshape(1, 1, 1, -1)

						# è®¡ç®—åŠ æƒè¾¹ç‰¹å¾
						E = noisy_data["E_t"] * bond_orders Â # (bs, n, n, de)
						
						âš  ç›¸åŒçš„é”™è¯¯
						# å¯¹æ¯æ¡è¾¹å–æœ€å¤§é”®çº§ï¼Œç„¶åå¯¹æ¯ä¸ªåŸå­çš„æ‰€æœ‰é‚»æ¥è¾¹æ±‚å’Œ
						ğŸ’¡ä¿®æ­£ï¼švalencies = E.sum(dim=-1).sum(dim=-1)
						â­å®šè®ºï¼šargmax èƒ½åŒºåˆ«ä¸åŒç±»å‹å°±å¯ä»¥ï¼Œä¸ç”¨ä¿®æ”¹
						valencies = E.argmax(dim=-1).sum(dim=-1) Â # (bs, n)
				
						return valencies.type_as(noisy_data["X_t"])
				```
			3. åˆ†å­é‡å½’ä¸€åŒ–
				```python
				class WeightFeature:
					def __init__(self, max_weight, atom_weights):
						# max_weight: æ•°æ®é›†ä¸­æœ€å¤§åˆ†å­é‡ï¼Œç”¨äºå½’ä¸€åŒ–
						self.max_weight = max_weight
						
						# atom_weights: å­—å…¸ï¼ŒåŸå­ç±»å‹ -> åŸå­é‡ï¼ˆå¦‚ {'C': 12, 'N': 14, 'O': 16}ï¼‰
						self.atom_weight_list = torch.tensor(list(atom_weights.values()))
					def __call__(self, noisy_data):
					
						"""
						è®¡ç®—å½’ä¸€åŒ–åˆ†å­é‡ã€‚
						æ­¥éª¤ï¼š
						1. ä» one-hot ç¼–ç ä¸­æå–åŸå­ç±»å‹ç´¢å¼•
						2. æ ¹æ®ç´¢å¼•æŸ¥æ‰¾åŸå­é‡
						3. æ±‚å’Œå¾—åˆ°åˆ†å­é‡ï¼Œé™¤ä»¥æœ€å¤§åˆ†å­é‡å½’ä¸€åŒ–
						"""
						
						# ä» one-hot ä¸­è·å–åŸå­ç±»å‹ç´¢å¼•
						X = torch.argmax(noisy_data["X_t"], dim=-1) Â # (bs, n)
					
						# æ ¹æ®åŸå­ç±»å‹ç´¢å¼•æŸ¥æ‰¾åŸå­é‡
						X_weights = self.atom_weight_list.to(X.device)[X] Â # (bs, n)
					
						# æ±‚å’Œå¾—åˆ°åˆ†å­é‡ï¼Œå½’ä¸€åŒ–åè¿”å›
						return (
							X_weights.sum(dim=-1).unsqueeze(-1).type_as(noisy_data["X_t"])
							/ self.max_weight
						) Â # (bs, 1)
				```
			4. `__call__ function`
				```python
				def __call__(self, noisy_data):
					# è°ƒç”¨å‰ä¸‰ä¸ªç±»è®¡ç®—
					charge = self.charge(noisy_data).unsqueeze(-1) Â # (bs, n, 1)
					valency = self.valency(noisy_data).unsqueeze(-1) Â # (bs, n, 1)
					weight = self.weight(noisy_data) Â # (bs, 1)
					
					# ä¸æ·»åŠ é¢å¤–è¾¹ç‰¹å¾
					# è¿™é‡Œéƒ½æ˜¯é’ˆå¯¹åŸå­çš„ç‰¹å¾ï¼Œä½†æ˜¯éœ€è¦ä¸€ä¸ªè¾¹çš„å ä½ç¬¦
					extra_edge_attr = torch.zeros((*noisy_data["E_t"].shape[:-1], 0)).type_as(
						noisy_data["E_t"]
					)
					
					return utils.PlaceHolder(
						X=torch.cat((charge, valency), dim=-1), E=extra_edge_attr, y=weight
					)
				```
	- è¾“å‡ºç»´åº¦
		```python
		self.output_dims = {
			"X": example_batch["x"].size(1),
			"E": example_batch["edge_attr"].size(1),
			"y": 0,
		}
		```
6. è¯„ä¼°ä¸å…¶ä»–å·¥å…·
	1. è®­ç»ƒæŒ‡æ ‡è®¡ç®—å™¨
	2. é‡‡æ ·è¯„ä¼°è®¡ç®—å™¨
	3. å¯è§†åŒ–å·¥å…·
7. åˆå§‹åŒ–æµæ¨¡å‹
	- ä¸€äº›æ„é€ å‡½æ•°ä¸­éœ€è¦æ³¨æ„çš„
		1. èŠ‚ç‚¹æ•°é‡çš„æ¦‚ç‡åˆ†å¸ƒï¼š`self.node_dist = dataset_infos.nodes_dist`
			- `node_dist` æ˜¯æ•°æ®é›†ä¸­èŠ‚ç‚¹æ•°é‡çš„æ¦‚ç‡åˆ†å¸ƒå¯¹è±¡ï¼Œç”¨äºåœ¨é‡‡æ ·ç”Ÿæˆæ–°å›¾æ—¶éšæœºç¡®å®šèŠ‚ç‚¹æ•°
		2. å™ªå£°å’Œæé™åˆ†å¸ƒï¼š`self.noise_dist = NoiseDistribution(cfg.model.transition, dataset_infos)`
			- `noise_dist` å®šä¹‰äº†ç¦»æ•£æµåŒ¹é…æ¨¡å‹ä¸­çš„å™ªå£°åˆ†å¸ƒå’Œæé™åˆ†å¸ƒï¼Œç”¨äºè®­ç»ƒå’Œé‡‡æ ·è¿‡ç¨‹ä¸­çš„éšæœºè½¬æ¢
		3. æé™åˆ†å¸ƒï¼š`self.limit_dist = self.noise_dist.get_limit_dist()`
			- `limit_dist` æ˜¯ç¦»æ•£æµåŒ¹é…ä¸­çš„æé™åˆ†å¸ƒï¼Œå®šä¹‰äº†åœ¨æ—¶é—´ $t \rightarrow \infty$ æ—¶å„ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç”¨äºæŒ‡å¯¼å™ªå£°é‡‡æ ·å’Œæ¦‚ç‡è®¡ç®—
		4. è½¬ç§»æœºåˆ¶ï¼šä¹Ÿå°±æ˜¯å®šä¹‰æ¨¡å‹æœ€ç»ˆçš„å™ªå£°åˆ†å¸ƒ
			1. å‡åŒ€åˆ†å¸ƒ `uniform`ï¼šæ¯ä¸ªç±»åˆ«æ¦‚ç‡ç›¸åŒ
			2. ç¬¬ä¸€ç±»å¸æ”¶æ€ `absorbfirst`ï¼š100% è½¬ä¸ºç¬¬0ç±»
			3. æœ€å¸¸è§çš„ç±»åˆ« `argmax`ï¼šç›®æ ‡ä¸»è¦æ˜¯æœ€é¢‘ç¹çš„ç±»åˆ«
			4. è™šæ‹Ÿå¸æ”¶æ€ `absorbing`ï¼š
				- è¿ç»­ï¼šåŠ å™ªè¿‡ç¨‹æ•°æ®é€æ¸å˜å¾—è¶Šæ¥è¶Šéšæœºï¼Œæœ€ç»ˆä¼šå˜æˆ **å®Œå…¨çš„å„å‘åŒæ€§é«˜æ–¯å™ªå£°** $\mathcal{N}(0, I)$ï¼Œè¿™ä¸ªç¨³å®šçš„ç»ˆç‚¹å°±æ˜¯å¸æ”¶æ€ï¼ˆä¸€æ—¦æ•°æ®åˆ°è¾¾è¿™ä¸ªçŠ¶æ€ï¼Œå†ç»§ç»­æ‰©æ•£ä¹Ÿä¸ä¼šæ”¹å˜åˆ†å¸ƒï¼‰
				- ç¦»æ•£ï¼šéœ€è¦ä¸€ä¸ªç¦»æ•£çŠ¶æ€çš„ç»ˆç‚¹æ¥ä»£æ›¿é«˜æ–¯åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯å¯¹è¾“å…¥çš„ `x, e` çš„ $\text{ont-hot}$ æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ç»´åº¦ $[ \underbrace{0,\ 0,\ \cdots,\ 0}_{\text{å‰}\ n\ \text{ç»´}},\  \underset{\mathclap{\substack{\uparrow \\ \text{å¸æ”¶æ€}}}}{1} ]$ ç”¨æ¥æ ‡è®°ç»ˆç‚¹
			5. çœŸå®åˆ†å¸ƒ `marginal`ï¼šæ•°æ®é›†ä¸­çš„çœŸå®åˆ†å¸ƒ
		5. è®­ç»ƒæŸå¤±å‡½æ•°ï¼š`self.train_loss = TrainLossDiscrete(self.cfg.model.lambda_train)`
		6. å›¾ Transformerï¼š`self.model = GraphTransformer(...)`
			- `mlp_in_*`ï¼š**ç»´åº¦é€‚é…** â€”â€” åŸå§‹ç‰¹å¾ â†’ éšå±‚ç»´åº¦
			- `tf_layers`ï¼š**ç‰¹å¾å­¦ä¹ ** â€”â€” é€šè¿‡å¤šå±‚ Transformer å­¦ä¹ å¤æ‚å…³ç³»
			- `mlp_out_*`ï¼š**ç»´åº¦æ¢å¤** â€”â€” éšå±‚ â†’ è¾“å‡ºç»´åº¦
		7. æ—¶é—´å˜å½¢å™¨ï¼ˆTime Distorterï¼‰ï¼šç”¨äºåœ¨è®­ç»ƒå’Œé‡‡æ ·æ—¶æ”¹å˜æ—¶é—´æ­¥çš„åˆ†å¸ƒæ–¹å¼
			- é€šè¿‡ä¸åŒçš„æ—¶é—´å˜å½¢å‡½æ•°å°†å‡åŒ€åˆ†å¸ƒçš„æ—¶é—´æ­¥Â $t \in [0,1]$Â è½¬æ¢æˆä¸åŒçš„åˆ†å¸ƒ
				- `identity`ï¼šä¸å˜ â€”â€”  $f(t) = t$           
				- `cos`ï¼šä½™å¼¦å˜å½¢ â€”â€” $f(t) = (1 - cos(\pi t))/2$ 
				- `revcos`ï¼šåä½™å¼¦ â€”â€” $f(t) = 2t - (1 - cos(\pi t))/2$
				- `polyinc`ï¼šäºŒæ¬¡é€’å¢ â€”â€” $f(t) = t^2$
				- `polydec`ï¼šäºŒæ¬¡é€’å‡ â€”â€” $f(t) = 2t - t^2$
		8. é€Ÿç‡çŸ©é˜µè®¾è®¡å™¨ï¼ˆRate Matrix Designerï¼‰ï¼šç”¨äºè®¡ç®—ç¦»æ•£æµåŒ¹é…ä¸­çš„**è½¬ç§»é€Ÿç‡çŸ©é˜µ**
			- å—åˆ°Â `eta`ï¼ˆéšæœºæ€§ï¼‰å’ŒÂ `omega`ï¼ˆå¼•å¯¼å¼ºåº¦ï¼‰çš„æ§åˆ¶ï¼ˆåˆ›æ–°ç‚¹ï¼‰
8. åˆå§‹åŒ– Pytorch Lightning çš„ `Trainer()`
9. å¼€å§‹è®­ç»ƒ `trainer.fit(model, datamodule=datamodule, ckpt_path=cfg.general.resume)`